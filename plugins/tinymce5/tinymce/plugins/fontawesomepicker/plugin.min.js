!function(){"use strict";function i(b){b.ui.registry.addIcon(a,h),b.ui.registry.addButton(a,{icon:a,tooltip:a,onAction:function(){b.execCommand("mceOpenFontawesomepicker")}}),b.ui.registry.addMenuItem(a,{icon:a,text:a,onAction:function(){b.execCommand("mceOpenFontawesomepicker")}}),b.ui.registry.addMenuItem("fontawesomesetting",{icon:"preferences",text:"Icon setting",onAction:function(){g(b)}}),b.ui.registry.addContextMenu("fontawesomesetting",{update:function(a){var b=a.classList;return b.contains("mark-fapk")||b.contains("mark-fapkw")?"fontawesomesetting":""}})}function k(){c.add(a,function(a,b){var c=j(a,b);return a.settings.extended_valid_elements=a.settings.extended_valid_elements||"",a.settings.extended_valid_elements+=",span[*]",a.settings.contextmenu=a.settings.contextmenu||"",a.settings.contextmenu+=" fontawesomesetting",a.addCommand("mceOpenFontawesomepicker",function(){c.open()}),i(a),{}})}var a="fontawesomepicker",b="fontawesomepickerCallback",c=tinymce.util.Tools.resolve("tinymce.PluginManager"),d={},e={loadStyle:function(a,b){if(!a.querySelector('link[href*="'+b+'"]')){var c=a.createElement("link");c.href=b,c.rel="stylesheet",a.head.appendChild(c)}},unique:function(a){var b=a.reduce(function(a,b){return a[b]=1,a},{});return Object.keys(b)},getRngNode:function(a){var b=a.selection.getRng(),c=b.startContainer;return 1!==c.nodeType&&(c=c.parentNode),c},jsonp:function(a,b,c){var e,f;d[a]=d[a]||{},e=d[a],e.status||e.script||(f=document.createElement("script"),f.src=a,document.head.appendChild(f),e.status=0,e.script=f,window[b]=function(a){e.status=1,e.data=a},e.script.onload=e.script.onerror=function(){delete window[b],delete e.script,this.parentNode&&this.parentNode.removeChild(this)}),!e.status&&e.script&&e.script.addEventListener("load",function(){c(e.data)}),e.status&&c(e.data)},getmatrix:function(a){var b=Math.round(180*Math.asin(a[0])/Math.PI),c=Math.round(180*Math.acos(a[1])/Math.PI),d=Math.round(180*Math.asin(a[2])/Math.PI),e=Math.round(180*Math.acos(a[3])/Math.PI),f=0;return b==c||-b==c?f=e:180==-b+c?f=180+d:180==b+c&&(f=360-d||360-e),f>=360?0:f}},f=function(){function d(b,c){var d=b.getParam("fontawesomeUrl"),g=b.getParam("fontawesomePro"),h=g?"pro":"free";e.loadStyle(document,d),e.loadStyle(document,c+"/asset/style.css"),e.loadStyle(document,c+"/asset/style-"+h+".css"),e.loadStyle(b.contentDocument,d),a.all||f(c+"/asset/categories-"+h+".js")}function f(a){e.jsonp(a,b,function(a){g(a)})}function g(b){a.all={icons:[],label:"all"};for(var c in b)a.all.icons=a.all.icons.concat(b[c].icons),a[c]=b[c];a.all.icons=e.unique(a.all.icons)}var a={},c="";return function(b,e){return b.on("init",d.bind(null,b,e)),{editor:b,open:function(){b.windowManager.open({title:"Icons",size:"large",body:{type:"panel",items:[{type:"htmlpanel",html:this.renderBody()}]},buttons:[{type:"cancel",name:"close",text:"Close",primary:!0}]}),this.openAfter()},openAfter:function(){var a=this;a.changeNav("all"),b.$(".mce-fontawesomepicker--nav__item",document).off("click").on("click",function(){var b=this.getAttribute("title");a.changeNav(b)}),b.$(".mce-fontawesomepicker--icon",document).off("click").on("click",function(){var b=this.getAttribute("title");a.insertIcon(b)})},renderNav:function(){var c,d,b="";b+='<div class="mce-fontawesomepicker--nav">';for(c in a)d=a[c],b+='<div class="mce-fontawesomepicker--nav__item" title="'+c+'">'+d.label+"</div>";return b+="</div>"},renderIcons:function(){var b=this,c="";return c+='<div class="mce-fontawesomepicker--icons">',c+=a.all.icons.reduce(function(a,c){var d=b.toIconClass(c);return a+='<div class="mce-fontawesomepicker--icon" title="'+c+'">',a+='	<span><i class="'+d+'"></i></span>',a+="	<span>"+c+"</span>",a+="</div>"},""),c+="</div>"},renderBody:function(){return c?c:(c+='<div class="mce-fontawesomepicker--body">',c+='	<div class="mce-fontawesomepicker--aside">',c+=this.renderNav(),c+="	</div>",c+='	<div class="mce-fontawesomepicker--content">',c+=this.renderIcons(),c+="	</div>",c+="</div>")},toIconClass:function(a){var b=a.split("-")[0],c=a.replace(b,b+" fa");return c},showIcons:function(c){var d=a[c];d&&b.$(".mce-fontawesomepicker--icon",document).each(function(){var b=this.getAttribute("title");this.style.display=d.icons.includes(b)?"block":"none"})},changeNav:function(a){var b=document.querySelector(".mce-fontawesomepicker--nav__item.current"),c=document.querySelector('.mce-fontawesomepicker--nav__item[title="'+a+'"]');b&&b.classList.remove("current"),c&&c.classList.add("current"),this.showIcons(a)},insertIcon:function(a){var c=this.toIconClass(a),d=' <span class="mark-fapkw"><!-- . --><span contenteditable="false" class="mark-fapk '+c+'"></span></span> ';b.execCommand("mceInsertContent",!1,d),b.windowManager.close()}}}},g=function(a){var b=e.getRngNode(a),c=a.$(b).children(".mark-fapk")[0],d=a.$(c).css("transform").replace(/(matrix|none|\(|\))/g,"");d=e.getmatrix(d.split(",").map(parseFloat)),a.windowManager.open({title:"Icon setting",body:{type:"panel",items:[{type:"selectbox",name:"icon-style",label:"Style",items:[{value:"none",text:"None"},{value:"rounded",text:"Circle"},{value:"boxed",text:"Square"},{value:"rounded-less",text:"Rounded"},{value:"rounded-outline",text:"Outline Circle"},{value:"boxed-outline",text:"Outline Square"},{value:"rounded-less-outline",text:"Outline Rounded"}]},{type:"input",name:"icon-size",label:"Icon size"},{type:"colorinput",name:"icon-color",label:"Icon color"},{type:"input",name:"icon-rotate",label:"Rotation angle (0deg)"},{type:"colorinput",name:"style-color",label:"Style color"}]},buttons:[{type:"cancel",name:"closeButton",text:"Cancel"},{type:"submit",name:"submitButton",text:"Change",primary:!0}],initialData:{"icon-style":a.$(b).attr("icon-style")||"none","icon-size":a.$(c).css("font-size"),"icon-color":a.$(c).css("color")||"","icon-rotate":d+"deg","style-color":a.$(b).attr("style-color")||""},onSubmit:function(d){var e=d.getData(),f={"font-size":e["icon-size"],color:e["icon-color"]};if(c.removeAttribute("style"),[0,"0","0deg"].includes(e["icon-rotate"])||(f["display"]="inline-block",f["transform"]="rotate("+e["icon-rotate"]+")",f["-ms-transform"]="rotate("+e["icon-rotate"]+")",f["-moz-transform"]="rotate("+e["icon-rotate"]+")",f["-webkit-transform"]="rotate("+e["icon-rotate"]+")",f["-o-transform"]="rotate("+e["icon-rotate"]+")"),"none"===e["icon-style"])b.removeAttribute("icon-style"),b.removeAttribute("style-color");else switch(a.$(b).attr("icon-style",e["icon-style"]),a.$(b).attr("style-color",e["style-color"]),f["display"]="inline-block",f["text-align"]="center",f["width"]=f["height"]=f["line-height"]="1.4em",e["icon-style"]){case"rounded":f["border-radius"]="50%",f["background-color"]=e["style-color"];break;case"boxed":f["background-color"]=e["style-color"];break;case"rounded-less":f["border-radius"]="5px",f["background-color"]=e["style-color"];break;case"rounded-outline":f["border-radius"]="50%",f["border"]="2px solid "+e["style-color"];break;case"boxed-outline":f["border"]="2px solid "+e["style-color"];break;case"rounded-less-outline":f["border-radius"]="5px",f["border"]="2px solid "+e["style-color"]}a.$(c).css(f),d.close()}})},h='<svg width="24" height="24" viewBox="0 0 512 512"><path d="M116.65 219.35a15.68 15.68 0 0 0 22.65 0l96.75-99.83c28.15-29 26.5-77.1-4.91-103.88C203.75-7.7 163-3.5 137.86 22.44L128 32.58l-9.85-10.14C93.05-3.5 52.25-7.7 24.86 15.64c-31.41 26.78-33 74.85-5 103.88zm143.92 100.49h-48l-7.08-14.24a27.39 27.39 0 0 0-25.66-17.78h-71.71a27.39 27.39 0 0 0-25.66 17.78l-7 14.24h-48A27.45 27.45 0 0 0 0 347.3v137.25A27.44 27.44 0 0 0 27.43 512h233.14A27.45 27.45 0 0 0 288 484.55V347.3a27.45 27.45 0 0 0-27.43-27.46zM144 468a52 52 0 1 1 52-52 52 52 0 0 1-52 52zm355.4-115.9h-60.58l22.36-50.75c2.1-6.65-3.93-13.21-12.18-13.21h-75.59c-6.3 0-11.66 3.9-12.5 9.1l-16.8 106.93c-1 6.3 4.88 11.89 12.5 11.89h62.31l-24.2 83c-1.89 6.65 4.2 12.9 12.23 12.9a13.26 13.26 0 0 0 10.92-5.25l92.4-138.91c4.88-6.91-1.16-15.7-10.87-15.7zM478.08.33L329.51 23.17C314.87 25.42 304 38.92 304 54.83V161.6a83.25 83.25 0 0 0-16-1.7c-35.35 0-64 21.48-64 48s28.65 48 64 48c35.2 0 63.73-21.32 64-47.66V99.66l112-17.22v47.18a83.25 83.25 0 0 0-16-1.7c-35.35 0-64 21.48-64 48s28.65 48 64 48c35.2 0 63.73-21.32 64-47.66V32c0-19.48-16-34.42-33.92-31.67z"/></svg>',j=f();k()}();