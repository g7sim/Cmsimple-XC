/*
 *	tiny-bs-grid https://github.com/jeffhehe/tiny-bs-grid
 *  this works for TinyMCE4.* on Bootstrap 3.*
 *  Version: v0.3
 *  Author: Jeff Wang
 *  Date: April 24, 2019
 */
tinymce.PluginManager.add("bootstrap3grid",function(x,e){x.contentCSS.push(e+"/bootstrapgrid-style.css"),x.addButton("bootstrap3grid",{type:"button",text:"BS3 Grid",tooltip:"Bootstrap3 Grid System",stateSelector:"div.row",cmd:"tinymce_bs3_grid"}),x.addCommand("tinymce_bs3_grid",function(){var e="Insert Bootstrap3 Grids",a="12",t="md",s=x.selection.getNode(),n=jQuery(s).parents("div.row"),d=0<n.length;if(d){var r=n[0],l=jQuery(r).children("div"),p=l.length,v=[];if(0<p)for(a="",i=0;i<p;i++){var o=jQuery(l[i]).attr("class").split(/\s+/),c=jQuery(l[i]).html();for(v.push(c),j=0;j<o.length;j++)if(/^col-.*/i.test(o[j])){0==j&&(-1<o[0].indexOf("col-lg")?t="lg":-1<o[0].indexOf("col-sm")?t="sm":-1<o[0].indexOf("col-xs")&&(t="xs"));var u=o[j].lastIndexOf("-"),b=o[j].substr(u+1);a+=b}}e="Update Bootstrap3 Grids"}var m=[{type:"listbox",name:"size",label:"Target Screen",values:[{text:"Large => 1200px",value:"lg"},{text:"Medium => 992px",value:"md"},{text:"Small => 768px",value:"sm"},{text:"X Small < 768px",value:"xs"}],value:t},{type:"listbox",name:"grid",label:"Grid",values:[{text:"1 Column",value:"12"},{text:"2 Columns (1:1)",value:"66"},{text:"2 Columns (2:1)",value:"84"},{text:"2 Columns (3:1)",value:"93"},{text:"2 Columns (1:2)",value:"48"},{text:"2 Columns (1:3)",value:"39"},{text:"3 Columns (1:1:1)",value:"444"},{text:"3 Columns (2:1:1)",value:"633"},{text:"3 Columns (1:2:1)",value:"363"},{text:"3 Columns (1:1:2)",value:"336"},{text:"4 Columns (1:1:1:1)",value:"3333"}],value:a},{type:"checkbox",name:"leadingBreak",label:"Add a Leading Line Break"}];d&&m.push({type:"checkbox",name:"removeGrids",label:"Remove Bootstrap Grids",onchange:function(e){var a=this.parent().prev(),t=a.prev(),s=t.prev();1==this.state.data.checked?(a.hide(),t.hide(),s.hide()):(a.show(),t.show(),s.show())}}),x.windowManager.open({title:e,width:450,height:150,body:m,onsubmit:function(r){var e="",l="",o="<p>&nbsp;</p>";if(1==r.data.leadingBreak&&(e="<p>&nbsp;</p>"),1==r.data.removeGrids&&d)return l=v.join("<p>&nbsp;</p>"),void jQuery(n).replaceWith(e+l+o);var a=function(e,a){if(d){if(0<p&&p<e){for(var t=0;t<p;t++)l+='<div class="col-'+r.data.size+"-"+a[t]+'">'+v.shift()+"</div>";for(var s=p;s<e;s++)l+='<div class="col-'+r.data.size+"-"+a[s]+'"><p>&nbsp;</p></div>'}else if(e<=p){for(var t=0;t<e;t++)l+='<div class="col-'+r.data.size+"-"+a[t]+'">'+v.shift()+"</div>";e<p&&(o="<p>&nbsp;</p>"+v.join("<p>&nbsp;</p>")+"<p>&nbsp;</p>")}}else for(var i=0;i<e;i++)l+='<div class="col-'+r.data.size+"-"+a[i]+'"><p>&nbsp;</p></div>'};switch(r.data.grid){case"12":a(1,[12]);break;case"66":a(2,[6,6]);break;case"84":a(2,[8,4]);break;case"93":a(2,[9,3]);break;case"48":a(2,[4,8]);break;case"39":a(2,[3,9]);break;case"444":a(3,[4,4,4]);break;case"633":a(3,[6,3,3]);break;case"363":a(3,[3,6,3]);break;case"336":a(3,[3,3,6]);break;case"3333":a(4,[3,3,3,3])}d?jQuery(n).replaceWith(e+'<div class="row">'+l+"</div>"+o):x.insertContent(e+'<div class="row">'+l+"</div>"+o)}})})});